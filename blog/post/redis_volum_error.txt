2:I[5250,["250","static/chunks/250-13017c899420a97f.js","811","static/chunks/app/blog/post/%5Bslug%5D/page-ed9e3038976c8e64.js"],""]
3:I[5613,[],""]
5:I[1778,[],""]
6:I[7629,["699","static/chunks/8e1d74a4-1e017a85df66f066.js","250","static/chunks/250-13017c899420a97f.js","185","static/chunks/app/layout-80b5836bb5bc03fa.js"],""]
7:"$Sreact.suspense"
8:I[102,["699","static/chunks/8e1d74a4-1e017a85df66f066.js","250","static/chunks/250-13017c899420a97f.js","185","static/chunks/app/layout-80b5836bb5bc03fa.js"],""]
4:["slug","redis_volum_error","d"]
0:["7IsVNekN1GiV50em3cSD3",[[["",{"children":["blog",{"children":["post",{"children":[["slug","redis_volum_error","d"],{"children":["__PAGE__?{\"slug\":\"redis_volum_error\"}",{}]}]}]}]},"$undefined","$undefined",true],["",{"children":["blog",{"children":["post",{"children":[["slug","redis_volum_error","d"],{"children":["__PAGE__",{},["$L1",["$","section",null,{"children":["$","div",null,{"className":"mt-10 pb-10 border-b-2 mb-10 prose dark:prose-invert","children":[["$","h1",null,{"className":"mb-8 font-bold text-2xl sm:text-4xl font-mono","children":"Redis EXECABORT Transaction discarded because of previous errors 에러"}],["$","div",null,{"className":"flex-auto mb-16","children":[["$","button","0",{"className":"h-8 px-3 m-1 text-xs transition-colors duration-150 bg-gray-200 rounded-lg cursor-pointer focus:shadow-outline hover:bg-gray-300","children":["$","$L2",null,{"href":{"pathname":"/category","query":{"category":"report"}},"children":"report"}]}],["$","button","1",{"className":"h-8 px-3 m-1 text-xs transition-colors duration-150 bg-gray-200 rounded-lg cursor-pointer focus:shadow-outline hover:bg-gray-300","children":["$","$L2",null,{"href":{"pathname":"/category","query":{"category":"redis"}},"children":"redis"}]}]]}],["$","div",null,{"className":"flex-auto mb-16","children":[["$","span",null,{"className":"text-sm","children":["$","a",null,{"href":"https://beenchangseo.github.io/","children":"beenchangseo"}]}],["$","span",null,{"className":"ml-1 mr-1","children":"·"}],["$","span",null,{"className":"text-sm font-medium text-gray-500","children":"2024년 3월 15일"}]]}],[["$","h2",null,{"children":"문제"}],"\n",["$","p",null,{"children":"거래소 마켓 데이터의 처리를 담당하는 모듈에서 장애가 발생하여 서비스 전체 기능이 멈추었다."}],"\n",["$","p",null,{"children":"해당 모듈은 pod 로그를 보니 아래 에러를 출력하면 재기동을 무한 반복하고 있었다."}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"Uahandeled promise rejection occured!\n[ErrorReply: EXECABORT Transaction discarded because of previous errors.]\n"}]}],"\n",["$","h2",null,{"children":"원인 분석"}],"\n",["$","p",null,{"children":"EXECABORT Transaction discarded because of previous errors\n직역하자면 exec 명령어가 abort 되었고, 그 이유는 이전 오류로 인해 트랜잭션 명령어가 삭제되었다."}],"\n",["$","p",null,{"children":"예상되는 문제는 2가지 정도"}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":"Transaction을 사용하는 redis 명령어에서 잘못된 명령어를 사용 후 exec 했을 경우"}],"\n",["$","li",null,{"children":"redis watch 명령어로 lock이 걸린 key를 변경하려고 시도 했는지 체크"}],"\n",["$","li",null,{"children":"메모리 부족"}],"\n"]}],"\n",["$","p",null,{"children":"1차적으로 최근 커밋으로 추가된 redis 서비스 로직이 있는지 체크 했다.\n배포된 feature 브랜치들중 redis를 사용하거나 기존 로직을 변경하는 커밋은 없었음."}],"\n",["$","p",null,{"children":"그럼 redis 메모리일 확률이 높기 때문에 redis 메모리를 조회해봤음."}],"\n",["$","pre",null,{"children":["$","code",null,{"children":"redis-cli info | grep memory\n"}]}],"\n",["$","p",null,{"children":"조회 해보니 메모리가 모자란 상황이었다.\n최근 메일 서비스를 bull message queue를 사용하여 보내도록 변경하였는데 대용량 벌크 메일을 처리하다가 메모리 부족으로 죽었던 것이었다."}],"\n",["$","p",null,{"children":"벌크 메일 모듈이 밀어넣는 메일 > 메일 전송 모듈의 전송 처리"}],"\n",["$","h2",null,{"children":"해결"}],"\n",["$","p",null,{"children":"처리하지 못한 job들을 따로 추출 후 백업 (전송되지 못한 메일들은 추후 재 전송 하기위함)"}],"\n",["$","p",null,{"children":"추출한 job과 관련된 redis key 삭제 처리"}],"\n",["$","p",null,{"children":"aws redis 용량 추가 후 나머지 벌크 메일 전송"}],"\n",["$","p",null,{"children":"추출 해놓았던 벌크 메일 job으로 다시 밀어넣기"}],"\n",["$","p",null,{"children":"job이 많이 쌓였을 경우 스케일 아웃 할 수 있도록 수정이 필요해보인다."}],"\n",["$","p",null,{"children":"이상 주말 출근 이유 일기 끝"}]]]}]}],null]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","post","children","$4","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","post","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}]]},[null,["$","html",null,{"lang":"en","className":"__className_aaf875","suppressHydrationWarning":true,"children":["$","body",null,{"children":["$","$L6",null,{"children":["$","$7",null,{"children":[["$","$L8",null,{}],["$","main",null,{"className":"transition duration-500 bg-white dark:bg-[#111111] text-black dark:text-white","children":["$","div",null,{"className":"max-w-screen-md flex flex-col px-10 m-auto","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"loading":"$undefined","loadingStyles":"$undefined","loadingScripts":"$undefined","hasLoading":false,"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[],"styles":null}]}]}],["$","footer",null,{"className":"w-full font-mono flex flex-col justify-center items-center pt-10 pb-6 transition duration-500 bg-white dark:bg-[#111111] dark:text-white text-black","children":[["$","div",null,{"className":"flex justify-center gap-4 items-center pt-4 border-t-2 w-36","children":[["$","a",null,{"href":"beenchangseo@gmail.com","className":"hover:scale-110 transition-transform duration-500 hover:text-green-500 hover:fill-green-500 dark:fill-white dark:hover:fill-green-500","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":"24","height":"24","viewBox":"0 0 24 24","children":["$","path",null,{"d":"M12 .02c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm6.99 6.98l-6.99 5.666-6.991-5.666h13.981zm.01 10h-14v-8.505l7 5.673 7-5.672v8.504z"}]}]}],["$","a",null,{"href":"https://github.com/beenchangseo","className":"hover:scale-110 transition-transform duration-500 hover:text-green-500 hover:fill-green-500 dark:fill-white dark:hover:fill-green-500","children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":"24","height":"24","viewBox":"0 0 24 24","children":["$","path",null,{"d":"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"}]}]}]]}],["$","div",null,{"className":"text-sm mt-2","children":"Copyright © 2024 Changbeen seo"}],["$","div",null,{"className":"text-xs mt-2","children":"beenchangseo"}]]}]]}]}]}]}],null]],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/1012292f99769622.css","precedence":"next","crossOrigin":""}]],"$L9"]]]]
9:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Redis EXECABORT Transaction discarded because of previous errors 에러"}],["$","meta","3",{"name":"description","content":"redis 메모리 부족으로 발생한 EXECABORT Transaction discarded because of previous errors 문제를 해결하는 포스팅 입니다."}],["$","meta","4",{"name":"keywords","content":"redis, EXECABORT, Transaction discarded because of previous errors, redis memory error"}],["$","meta","5",{"property":"og:title","content":"Redis EXECABORT Transaction discarded because of previous errors 에러"}],["$","meta","6",{"property":"og:description","content":"redis 메모리 부족으로 발생한 EXECABORT Transaction discarded because of previous errors 문제를 해결하는 포스팅 입니다."}],["$","meta","7",{"property":"og:url","content":"https://beenchangseo.github.io/redis_volum_error"}],["$","meta","8",{"property":"og:site_name","content":"Beenchangseo Blog"}],["$","meta","9",{"property":"og:locale","content":"ko_KR"}],["$","meta","10",{"property":"og:type","content":"article"}],["$","meta","11",{"property":"article:tag","content":"redis"}],["$","meta","12",{"property":"article:tag","content":"EXECABORT"}],["$","meta","13",{"property":"article:tag","content":"Transaction discarded because of previous errors"}],["$","meta","14",{"property":"article:tag","content":"redis memory error"}],["$","meta","15",{"name":"twitter:card","content":"summary"}],["$","meta","16",{"name":"twitter:creator","content":"beenchangseo"}],["$","meta","17",{"name":"twitter:title","content":"Redis EXECABORT Transaction discarded because of previous errors 에러"}],["$","meta","18",{"name":"twitter:description","content":"redis 메모리 부족으로 발생한 EXECABORT Transaction discarded because of previous errors 문제를 해결하는 포스팅 입니다."}],["$","meta","19",{"name":"next-size-adjust"}]]
1:null
